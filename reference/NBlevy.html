<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Negative Binomial Levy process — NBlevy • Renext</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Negative Binomial Levy process — NBlevy"><meta name="description" content="

Negative Binomial Lévy process estimation from partial observations (counts)
"><meta property="og:description" content="

Negative Binomial Lévy process estimation from partial observations (counts)
"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Renext</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.1-5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/IRSN/Renext/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Negative Binomial Levy process</h1>

      <div class="d-none name"><code>NBlevy.Rd</code></div>
    </div>

    <div class="ref-description section level2">


<p>Negative Binomial Lévy process estimation from partial observations (counts)</p>
<p></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">NBlevy</span><span class="op">(</span><span class="va">N</span>,</span>
<span>       gamma <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>       prob <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>       w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       sum.w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span>,</span>
<span>       interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">1000</span><span class="op">)</span>,</span>
<span>       optim <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>       plot <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-n">N<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd>

<p>Vector of counts, one count by time period.</p>
<p></p></dd>

  <dt id="arg-gamma">gamma<a class="anchor" aria-label="anchor" href="#arg-gamma"></a></dt>
<dd>

<p>The <code>gamma</code> parameter if known (NOT IMPLEMENTED YET).</p>
<p></p></dd>

  <dt id="arg-prob">prob<a class="anchor" aria-label="anchor" href="#arg-prob"></a></dt>
<dd>

<p>The <code>prob</code> parameter if known (NOT IMPLEMENTED YET).</p>
<p></p></dd>

  <dt id="arg-w">w<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd>

<p>Vector of time length (durations).</p>
<p></p></dd>

  <dt id="arg-sum-w">sum.w<a class="anchor" aria-label="anchor" href="#arg-sum-w"></a></dt>
<dd>

<p>NOT IMPLEMENTED YET. The effective duration. If <code>sum.w</code> is
    strictly inferior to <code>sum(w)</code>, it is to be understood that
    missing periods occur within the counts period. This can be taken
    into account with a suitable algorithm (Expectation Maximisation,
    etc.)</p>
<p></p></dd>

  <dt id="arg-interval">interval<a class="anchor" aria-label="anchor" href="#arg-interval"></a></dt>
<dd>

<p>Interval giving min and max values for <code>gamma</code>.</p>
<p></p></dd>

  <dt id="arg-optim">optim<a class="anchor" aria-label="anchor" href="#arg-optim"></a></dt>
<dd>

<p>If <code>TRUE</code> a one-dimensional optimisation is used. Else the zero
    of the derivative of the (concentrated) log-likelihood is searched
    for.</p>
<p></p></dd>

  <dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd>

<p>Should a plot be drawn? <em>May be removed in the future</em>.</p>
<p></p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed to <code>plot</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>


<p>The vector \(\mathbf{N}\) contains counts for events occurring on
  non-overlapping time periods with lengths given in
  \(\mathbf{w}\).  Under the NB Lévy process
  assumptions, the observed counts (i.e. elements of
  \(\mathbf{N}\)) are independent random variables, each following
  a negative binomial distribution.  The size parameter \(r_k\)
  for \(N_k\) is \(r_k = \gamma w_k\) and
  the probability parameter \(p\) is <code>prob</code>.  The vector
  \(\boldsymbol{\mu}\) of the expected counts has elements
  $$\mu_k=\mathrm{E}(N_k)=\frac{1-p}{p} \,\gamma \,w_k.$$</p>
<p>The parameters \(\gamma\) and \(p \:(\code{prob})\)
  are estimated by Maximum Likelihood using the likelihood concentrated
  with respect to the <code>prob</code> parameter.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the results</p>
<dl><dt>estimate</dt>
<dd>

<p>Parameter estimates.</p>
<p></p></dd>

  <dt>sd</dt>
<dd>

<p>Standard deviation for the estimate.</p>
<p></p></dd>

  <dt>score</dt>
<dd>

<p>Score vector at the estimated parameter vector.</p>
<p></p></dd>

  <dt>info</dt>
<dd>

<p>Observed information matrix.</p>
<p></p></dd>

  <dt>cov</dt>
<dd>

<p>Covariance matrix (approx.).</p>
<p></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kozubowski T.J. and Podgórsky K. (2009)
  "Distributional properties of the negative binomial Lévy process".
  <em>Probability and Mathematical Statistics</em> <b>29</b>, pp. 43-71.
  Lund University Publications.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Yves Deville</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>


<p>The Negative Binomial Lévy process is an alternative to
  the Homogeneous Poisson Process when counts are subject to
  overdispersion. In the NB process, all counts share the same index of
  dispersion (variance/expectation ratio), namely <code>1/prob</code>. When
  <code>prob</code> is close to 1, the counts are nearly Poisson-distributed.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">NegBinomial</a></code> for the negative binomial distribution,
  <code><a href="https://rdrr.io/pkg/MASS/man/glm.nb.html" class="external-link">glm.nb</a></code> from the MASS package for fitting Generalised
  Linear Model of the negative binomial family.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## known parameters</span></span></span>
<span class="r-in"><span><span class="va">nint</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">gam</span> <span class="op">&lt;-</span> <span class="fl">6</span>; <span class="va">prob</span> <span class="op">&lt;-</span> <span class="fl">0.20</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## draw random w, then the counts N</span></span></span>
<span class="r-in"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="va">nint</span>, shape <span class="op">=</span> <span class="fl">3</span>, scale <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">rnbinom</a></span><span class="op">(</span><span class="va">nint</span>, size <span class="op">=</span> <span class="va">w</span> <span class="op">*</span> <span class="va">gam</span>, prob <span class="op">=</span> <span class="va">prob</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">w</span> <span class="op">*</span> <span class="va">gam</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">prob</span><span class="op">)</span> <span class="op">/</span> <span class="va">prob</span></span></span>
<span class="r-in"><span><span class="va">Res</span> <span class="op">&lt;-</span> <span class="fu">NBlevy</span><span class="op">(</span>N <span class="op">=</span> <span class="va">N</span>, w <span class="op">=</span> <span class="va">w</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Use example data 'Brest'</span></span></span>
<span class="r-in"><span><span class="co">## compute the number of event and duration of the non-skipped periods</span></span></span>
<span class="r-in"><span><span class="va">gof1</span> <span class="op">&lt;-</span> <span class="fu"><a href="gof.date.html">gof.date</a></span><span class="op">(</span>date <span class="op">=</span> <span class="va">Brest</span><span class="op">$</span><span class="va">OTdata</span><span class="op">$</span><span class="va">date</span>,</span></span>
<span class="r-in"><span>                 skip <span class="op">=</span> <span class="va">Brest</span><span class="op">$</span><span class="va">OTmissing</span>,</span></span>
<span class="r-in"><span>                 start <span class="op">=</span> <span class="va">Brest</span><span class="op">$</span><span class="va">OTinfo</span><span class="op">$</span><span class="va">start</span>,</span></span>
<span class="r-in"><span>                 end <span class="op">=</span> <span class="va">Brest</span><span class="op">$</span><span class="va">OTinfo</span><span class="op">$</span><span class="va">end</span>,</span></span>
<span class="r-in"><span>                 plot.type <span class="op">=</span> <span class="st">"omit"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="NBlevy-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">ns1</span> <span class="op">&lt;-</span> <span class="va">gof1</span><span class="op">$</span><span class="va">noskip</span></span></span>
<span class="r-in"><span><span class="co">## fit the NBlevy</span></span></span>
<span class="r-in"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">NBlevy</span><span class="op">(</span>N <span class="op">=</span> <span class="va">ns1</span><span class="op">$</span><span class="va">nevt</span>, w <span class="op">=</span> <span class="va">ns1</span><span class="op">$</span><span class="va">duration</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## use a higher threshold</span></span></span>
<span class="r-in"><span><span class="va">OT2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">Brest</span><span class="op">$</span><span class="va">OTdata</span>, <span class="va">Surge</span> <span class="op">&gt;</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gof2</span> <span class="op">&lt;-</span> <span class="fu"><a href="gof.date.html">gof.date</a></span><span class="op">(</span>date <span class="op">=</span> <span class="va">OT2</span><span class="op">$</span><span class="va">date</span>,</span></span>
<span class="r-in"><span>                 skip <span class="op">=</span> <span class="va">Brest</span><span class="op">$</span><span class="va">OTmissing</span>,</span></span>
<span class="r-in"><span>                 start <span class="op">=</span> <span class="va">Brest</span><span class="op">$</span><span class="va">OTinfo</span><span class="op">$</span><span class="va">start</span>,</span></span>
<span class="r-in"><span>                 end <span class="op">=</span> <span class="va">Brest</span><span class="op">$</span><span class="va">OTinfo</span><span class="op">$</span><span class="va">end</span>,</span></span>
<span class="r-in"><span>                 plot.type <span class="op">=</span> <span class="st">"omit"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="NBlevy-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">ns2</span> <span class="op">&lt;-</span> <span class="va">gof2</span><span class="op">$</span><span class="va">noskip</span></span></span>
<span class="r-in"><span><span class="co">## the NBlevy prob is now closer to 1</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">NBlevy</span><span class="op">(</span>N <span class="op">=</span> <span class="va">ns2</span><span class="op">$</span><span class="va">nevt</span>, w <span class="op">=</span> <span class="va">ns2</span><span class="op">$</span><span class="va">duration</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">$</span><span class="va">prob</span>, <span class="va">fit2</span><span class="op">$</span><span class="va">prob</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3203404 0.5162115</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yves Deville, Bardet, Yann Richet.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

