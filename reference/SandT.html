<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="

Compute the empirical survival values and the empirical return periods
  at the observations of an object. These are used as plotting positions
  in several plots."><title>Compute empirical survivals (S) and return periods (T) — SandT • Renext</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute empirical survivals (S) and return periods (T) — SandT"><meta property="og:description" content="

Compute the empirical survival values and the empirical return periods
  at the observations of an object. These are used as plotting positions
  in several plots."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Renext</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.1-4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/IRSN/Renext/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compute empirical survivals (S) and return periods (T)</h1>
      
      <div class="d-none name"><code>SandT.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    

<p>Compute the empirical survival values and the empirical return periods
  at the observations of an object. These are used as plotting positions
  in several plots.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SandT</span><span class="op">(</span><span class="va">object</span>, points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="st">"H"</span><span class="op">)</span>, a <span class="op">=</span> <span class="fl">0</span>, naive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd>

<p>The object containing the data, with class <code>"Renouv"</code> or
    <code>"Rendata"</code>.</p>
<p></p></dd>

  <dt>points</dt>
<dd>

<p>Option for the computation of the plotting positions.  When
    <code>points</code> is set to <code>"p"</code>, the \(p\)-points formula is
    used with the selected value of <code>a</code>. This formula is used to
    compute the survival from which the return period is computed. When
    instead <code>points</code> is set to <code>"H"</code>, <em>Nelson's formula</em>
    is used to compute the return periods, the survival value still
    being given by the \(p\)-points formula. When the data is
    heterogeneous, i.e.  when <code>object</code> contains <code>MAX</code> and/or
    <code>OTS</code> data, Nelson's formula is used only to compute the return
    periods of the upper slice of levels.</p>
<p></p></dd>

  <dt>a</dt>
<dd>

<p>Parameter used in the interpolation formula for the inverse return
    periods as in Hirsch and Stedinger (1987).</p>    
<p></p></dd>

  <dt>naive</dt>
<dd>

<p>Logical. When <code>TRUE</code>, naive plotting positions are used to
    display <code>MAX</code> or <code>OTS</code> data. These can be defined only
    when a main sample exists in <code>object</code> as a <code>x.OT</code> element.
    For each <code>MAX</code> or <code>OTS</code> block, the positions use the
    number of events predicted using the rate of events as estimated
    from the main sample. When the main sample has a small durations,
    such predictions are likely to be misleading.</p></dd>

  
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    


<p>A list with the following elements</p>
<dl><dt>x</dt>
<dd>

<p>Numeric vector containing the ordered values from all the available
    sources in the object: main sample, historical periods either 'MAX' or
    'OTS'.</p>    
<p></p></dd>

  <dt>group, groupNames</dt>
<dd>

<p>Integer and character vectors giving the source of the values in
    <code>x</code>, in the same order of the values. For instance,
    <code>group[10]</code> gives the group form which <code>x[10]</code> was
    extracted, and the name of this group is <code>groupNames[group[10]]</code>.</p>    
<p></p></dd>

  <dt>S, T</dt>
<dd>
    
<p>Numeric vectors of the same length as <code>x</code> and containing the
    corresponding estimation of the survival value and of the return
    period.</p>
<p></p></dd>

  <dt>thresh, lambda.thresh, S.thresh, T.thresh</dt>
<dd>

<p>Vector of thresholds and the corresponding estimation for the event
    rate, survival and return period. All the estimations are <em>for
      the threshold values</em>. The value of <code>T.thresh[i]</code> for a threshold
    <code>thresh[i]</code> results from a simple computation: divide the sum of
    the durations for blocks with thresholds <code>&gt;= thresh[i]</code> by the
    number of events for these blocks.</p>    
<p></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    
  
<p>When the object contains historical information (<code>MAX</code> or
  <code>OTS</code>), the computation is an adaptation Hirsch and Stedinger
  (1987) for the Marked Process (MP) context. The original method is
  devoted to block maxima and interpolates the survival values at the
  thresholds which are computed first. For MP, the interpolation is
  done for the inverse return periods, and the survival values are
  deduced from those of the inverse return periods.</p>
<p>Nelson's formula provides unbiased estimates for the values of the
  cumulative hazard \(H(x)\) at the order statistics, and thus
  can be used to estimate the log-return periods as required on the
  return level plot.</p>
    </div>
    <div class="section level2">
    <h2 id="seealso">seealso<a class="anchor" aria-label="anchor" href="#seealso"></a></h2>
    <p>The <code><a href="https://rdrr.io/r/stats/ppoints.html" class="external-link">ppoints</a></code> and <code><a href="Hpoints.html">Hpoints</a></code> functions.</p>
    </div>
    <div class="section level2">
    <h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a></h2>
    

<p>When using <code>points = "H"</code> the estimated values of the survival
  returned in <code>S</code> and those for the return period <code>T</code> no
  longer verify <code>T=1/S/lambda</code>, where <code>lambda</code> is the
  estimated rate. In this case, the values in <code>T</code> should be used in
  the return level plot, while the values in <code>S</code> should be used in
  the PP-plot.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Yves Deville</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>The original method for block maxima is described in</p><ul><li><p>Hirsch R.M. and Stedinger J.R.(1887) Plotting Positions
  for Historical Floods and their precision. <em>Water
    Ressources Research</em>, vol. 23, N. 4 pp. 715-727.</p></li>
<li><p>Millard S. and Neerchal N. (2001). <em>Environmental
    Statistics with S-Plus</em>. CRC Press</p></li>
</ul><p>The adaptation for the Marked Process context is
described in the <em>Renext Computing Details</em>
document.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## use an object with class "Rendata"</span></span></span>
<span class="r-in"><span><span class="va">ST1</span> <span class="op">&lt;-</span> <span class="fu">SandT</span><span class="op">(</span>object <span class="op">=</span> <span class="va">Garonne</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## basic return level plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ST1</span><span class="op">$</span><span class="cn">T</span>, <span class="va">ST1</span><span class="op">$</span><span class="va">x</span>, col <span class="op">=</span> <span class="va">ST1</span><span class="op">$</span><span class="va">group</span>, log <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="SandT-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">## use an object with class "Renouv"</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="Renouv.html">Renouv</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Garonne</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ST2</span> <span class="op">&lt;-</span> <span class="fu">SandT</span><span class="op">(</span>object <span class="op">=</span> <span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ST2</span><span class="op">$</span><span class="cn">T</span>, <span class="va">ST2</span><span class="op">$</span><span class="va">x</span>, col <span class="op">=</span> <span class="va">ST2</span><span class="op">$</span><span class="va">group</span>, log <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="SandT-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Yann Richet.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

