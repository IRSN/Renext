<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Barplot for Renouv "Over Threshold" counts — barplotRenouv • Renext</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Barplot for Renouv " over threshold counts barplotrenouv><meta name="description" content='Barplot for "Over Threshold" counts in time blocks (usually years)'><meta property="og:description" content='Barplot for "Over Threshold" counts in time blocks (usually years)'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Renext</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.1-5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/IRSN/Renext/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Barplot for Renouv "Over Threshold" counts</h1>

      <div class="d-none name"><code>barplotRenouv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Barplot for "Over Threshold" counts in time blocks (usually years)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">barplotRenouv</span><span class="op">(</span><span class="va">data</span>,</span>
<span>               blockname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>               varname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>               threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="va">varname</span><span class="op">]</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>               na.block <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               main <span class="op">=</span> <span class="cn">NULL</span>, xlab <span class="op">=</span> <span class="cn">NULL</span>, ylab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               mono <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               prob.theo <span class="op">=</span> <span class="fl">0.999</span>,</span>
<span>               <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd>

<p>A dataframe object containing the variables.</p>
<p></p></dd>

  <dt id="arg-blockname">blockname<a class="anchor" aria-label="anchor" href="#arg-blockname"></a></dt>
<dd>

<p>Name of the "block" variable (column in <code>data</code>). This variable
    should contain integers, or be of class "factor", but with integer
    values such as year numbers.</p>
<p></p></dd>

  <dt id="arg-varname">varname<a class="anchor" aria-label="anchor" href="#arg-varname"></a></dt>
<dd>

<p>Name of the variable (e.g. <code>"Surge"</code>).</p>
<p></p></dd>

  <dt id="arg-threshold">threshold<a class="anchor" aria-label="anchor" href="#arg-threshold"></a></dt>
<dd>

<p>Only obs for which the variable exceeds <code>threshold</code> will be
    taken into account.</p>
<p></p></dd>

  <dt id="arg-na-block">na.block<a class="anchor" aria-label="anchor" href="#arg-na-block"></a></dt>
<dd>

<p>Values of blocks containing missing values. See the Details section.</p>
<p></p></dd>

  <dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd>

<p>If <code>FALSE</code> tests are computed without producing any plot.</p>
<p></p></dd>

  <dt id="arg-main">main<a class="anchor" aria-label="anchor" href="#arg-main"></a></dt>
<dd>

<p>Character for main title or <code>NULL</code> in which case a default main
    title is used.</p>
<p></p></dd>

  <dt id="arg-xlab">xlab<a class="anchor" aria-label="anchor" href="#arg-xlab"></a></dt>
<dd>

<p>Character for x axis label or <code>NULL</code> in which case a default
    lab is used.</p>
<p></p></dd>

  <dt id="arg-ylab">ylab<a class="anchor" aria-label="anchor" href="#arg-ylab"></a></dt>
<dd>

<p>Character for y axis or <code>NULL</code> in which case a default lab is
    used.</p>
<p></p></dd>

  <dt id="arg-mono">mono<a class="anchor" aria-label="anchor" href="#arg-mono"></a></dt>
<dd>

<p>If <code>FALSE</code> barplot will have colors, else greyscale will be
    used.</p>
<p></p></dd>

  <dt id="arg-prob-theo">prob.theo<a class="anchor" aria-label="anchor" href="#arg-prob-theo"></a></dt>
<dd>

<p>The total theoretical probability corresponding to the plotted
    (theoretical) bars.</p></dd>
  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further args to be passed to
    <code>barplot</code>.</p>
<p></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>


<p>Blocks described in the <code>na.block</code> are omitted in the
   determination of counts. The object given in the <code>na.block</code> is
   coerced to character and the same is done for values of <code>block</code>
   before comparing them to the <code>na.block</code> values.  If <code>block</code>
   variable is of class factor with levels representing years
   (e.g. 1980, 1981, etc.) missing blocks can be specified either as
   <code>c("1980", "1981")</code> or as numeric <code>c(1980, 1981)</code>.</p>
<p>For the chi-square test, counts for neighbouring frequency classes are
   grouped in order to reach a minimum frequency of <code>5</code> in each
   group. E.g. if we expect respectively <code>1.0</code>, <code>3.8</code> and
   <code>7.0</code> blocks with frequency <code>0</code>, <code>1</code> and <code>2</code> for
   events, the three counts are grouped in one group with frequency
   <code>1.0+3.8+7.0=11.8</code>. Note that this strategy of grouping is not
   unique and is likely to weaken the power of the test. Before
   grouping, the higher class theoretical probability is computed as the
   probability to obtain a count equal to or greater than the max value.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the following objects.</p>
<dl><dt>freq</dt>
<dd>

<p>frequency table (matrix) giving observed and theoretical (Poisson)
    frequencies as well as a group number for the chi-square test.</p>
<p></p></dd>

  <dt>overdispersion</dt>
<dd>

<p>the overdispersion coefficient (variance/mean ratio).</p>
<p></p></dd>

  <dt>disp.test</dt>
<dd>

<p>a list giving results of the (over)dispersion
    test. See the reference Yagouti and al. in the <b>References</b>
    section.</p>
<p></p></dd>

  <dt>chisq.test</dt>
<dd>

<p>a list giving results for the chis-square test of goodness-of-fit to
    the Poisson distribution.</p>
<p></p></dd>

  <dt>tests</dt>
<dd><p>a matrix with the two tests displayed in two rows.</p></dd>

</dl><p>For both tests, the statistic follows a chi-square distribution under the
  null hypothesis . The list of results contains the statistic
  <code>statistic</code>, the number of degrees of freedom <code>df</code> and
  the \(p\)-value <code>p.value</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>


<p>See Yagouti A., Abi-Zeid I., Ouarda, T.B.M.J. and
  B. Bobée (2001), Revue de processus ponctuels et
  synthèse de tests statistiques pour le choix d'un type
  de processus <em>Revue des Sciences de l'Eau</em>, <b>1</b>,
  pp. 323-361.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Yves Deville</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>


<p>The two tests: (over-)dispersion and chi-square have <em>one-sided</em> (upper
  tail) \(p\)-value. In other words, we do not intend to reject when
  statistics take "abnormally small" values, but only when abnormally
  large values are met.</p>
<p><!-- %%  The 'expected' and 'observed' counts in the \code{freq} object do -->
<!-- %%  have slightly different totals since the Poisson distribution -->
<!-- %%  takes values that are greater than the observed ones. --></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="plot.Rendata.html">plot.Rendata</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## na.block influence for Brest data</span></span></span>
<span class="r-in"><span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">bp1</span> <span class="op">&lt;-</span> <span class="fu">barplotRenouv</span><span class="op">(</span>data <span class="op">=</span> <span class="va">Brest.years</span>, threshold <span class="op">=</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span>         main <span class="op">=</span> <span class="st">"missing periods ignored"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit test (Poisson). Stat = 277.1667 df = 8 p-value = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dispersion index 4.208457 p-value 0 </span>
<span class="r-in"><span><span class="va">bp2</span> <span class="op">&lt;-</span> <span class="fu">barplotRenouv</span><span class="op">(</span>data <span class="op">=</span> <span class="va">Brest.years</span>, threshold <span class="op">=</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span>         na.block <span class="op">=</span> <span class="fl">1992</span>, main <span class="op">=</span> <span class="st">"1992 missing"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of obs. in NA blocks: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit test (Poisson). Stat = 271.7896 df = 8 p-value = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dispersion index 4.170886 p-value 0 </span>
<span class="r-in"><span><span class="va">bp3</span> <span class="op">&lt;-</span> <span class="fu">barplotRenouv</span><span class="op">(</span>data <span class="op">=</span> <span class="va">Brest.years</span>, threshold <span class="op">=</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span>         na.block <span class="op">=</span> <span class="fl">1991</span><span class="op">:</span><span class="fl">1993</span>, main <span class="op">=</span><span class="st">"1991:1993 missing"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of obs. in NA blocks: 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit test (Poisson). Stat = 261.2294 df = 8 p-value = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dispersion index 4.094299 p-value 0 </span>
<span class="r-in"><span><span class="va">bp4</span> <span class="op">&lt;-</span> <span class="fu">barplotRenouv</span><span class="op">(</span>data <span class="op">=</span> <span class="va">Brest.years</span>, threshold <span class="op">=</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span>         na.block <span class="op">=</span> <span class="va">Brest.years.missing</span>, main <span class="op">=</span> <span class="st">"all missing periods"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of obs. in NA blocks: 46 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit test (Poisson). Stat = 30.97919 df = 8 p-value = 0.0001417065 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dispersion index 1.791952 p-value 4.850723e-07 </span>
<span class="r-plt img"><img src="barplotRenouv-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## threshold influence</span></span></span>
<span class="r-in"><span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">thresh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">35</span>, <span class="fl">40</span>, <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">thresh</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">bp</span>  <span class="op">&lt;-</span> <span class="fu">barplotRenouv</span><span class="op">(</span>data <span class="op">=</span> <span class="va">Brest.years</span>, threshold <span class="op">=</span> <span class="va">thresh</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                   na.block <span class="op">=</span> <span class="va">Brest.years.missing</span>,</span></span>
<span class="r-in"><span>                   main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"threshold ="</span>, <span class="va">thresh</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"cm at Brest"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of obs. in NA blocks: 46 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit test (Poisson). Stat = 30.97919 df = 8 p-value = 0.0001417065 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dispersion index 1.791952 p-value 4.850723e-07 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of obs. in NA blocks: 46 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit test (Poisson). Stat = 24.5375 df = 7 p-value = 0.0009161369 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dispersion index 1.740394 p-value 1.827177e-06 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of obs. in NA blocks: 46 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit test (Poisson). Stat = 21.5105 df = 5 p-value = 0.000648504 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dispersion index 1.605952 p-value 4.652672e-05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of obs. in NA blocks: 46 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-fit test (Poisson). Stat = 5.722912 df = 3 p-value = 0.1258975 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dispersion index 1.159493 p-value 0.1181542 </span>
<span class="r-plt img"><img src="barplotRenouv-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yves Deville, Bardet, Yann Richet.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

